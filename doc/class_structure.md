
How to use np1sec library to secure your chat client MyInsecChatClient
======================================================================

You will need to implement an interface file similar to

test/chat_mocker_np1sec_plugin.cc

in particular you should call:
- np1secUserState::Join when the user joins a room.
- np1secUserState::leave_room when user intends to leave the room.

- np1secUserState::nincrement_room_size when somebody else joins the room.
- np1secUserState::shrink when somebody leaves the room.

- np1secUserState::send_handler: when the user wants to send a message to the room.
- np1secUserState::receive_handler: when a message is received by the room.

Also by setting following pointers you need to provide np1sec with suitable functionality:

- np1secAppOps::send_bare should send a text message (as is) to the room.
- np1secAppOps::join should update user ui that somebody has joined the room.
- np1secAppOps::leave  should update user ui when someone has left the room.
- np1secAppOps::display_message should display a message in the room ui.
- np1secAppOps::validate_long_term_key: should tell np1sec if a long term key belongs to a participant or not.
- np1secAppOps::set_timer: should set a one time timed callback.
- np1secAppOps::axe_timer: should disarm a previous set timer.


Class Structure
===============

## np1secUserState

represents an account that corresponds to a user logged into the chat server, it keeps
a list of rooms that the user has joined.

## np1secRoom

represents a room on the chat server and manages a list of sessions of the room and
session room transitions

## np1secSession

Represents a secure set of participants with a common encryption key. Each session keeps a of list participants

## Participant

Represents each participant in the room. It stores information about the participant's: p2p key, public key for signature and authentication, etc.

## ChatMocker
Is a mock chat server and client, simulating a chat server by storing all messages sent to a room in a queue. It eventually delivers all messages to all participants in the room.


How does it work?
=================
When np1secUserState is signaled that the user has joined the room, np1secRoom corresponds to that room that was constructed, the user (if not alone in the room) sends its own ephemeral key and asks the participants in the room to join the room. Participants in the room initiate a new session in that room to include the joiner. If the np1sec protocol fininshes successfully a new active_session will be constructed and participants start using encryption in the new session.

In the same way when a user leave the room, a new session is generated by the paticipant to generate a new key to exclude the leaving user.

Each session also has a time span, when the time is up, all users generate a new session and when it is constructed it is going to be replaced the current session.
