<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>(n+1)sec: np1sec::Cryptic Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">(n+1)sec
   &#160;<span id="projectnumber">Version 1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacenp1sec.html">np1sec</a></li><li class="navelem"><a class="el" href="classnp1sec_1_1Cryptic.html">Cryptic</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a> &#124;
<a href="classnp1sec_1_1Cryptic-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">np1sec::Cryptic Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Encryption primitives and related definitions.  
 <a href="classnp1sec_1_1Cryptic.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="crypt_8h_source.html">crypt.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a54611544c61e55c6c39e32a01fc4dc8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a54611544c61e55c6c39e32a01fc4dc8f">set_session_key</a> (const <a class="el" href="namespacenp1sec.html#a19000427258366e54c060914e1d9b389">HashBlock</a> <a class="el" href="classnp1sec_1_1Cryptic.html#a938818a52129ea69a4b360e4468d8334">session_key</a>)</td></tr>
<tr class="separator:a54611544c61e55c6c39e32a01fc4dc8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2d26c2bd24ca7cb0730dacee1cbf36d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#af2d26c2bd24ca7cb0730dacee1cbf36d">Cryptic</a> ()</td></tr>
<tr class="memdesc:af2d26c2bd24ca7cb0730dacee1cbf36d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor setup the key.  <a href="#af2d26c2bd24ca7cb0730dacee1cbf36d">More...</a><br /></td></tr>
<tr class="separator:af2d26c2bd24ca7cb0730dacee1cbf36d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1eb3faf679b5ac141cf49a5e864d323f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a1eb3faf679b5ac141cf49a5e864d323f">Cryptic</a> (const <a class="el" href="classnp1sec_1_1Cryptic.html">Cryptic</a> &amp;rhs)</td></tr>
<tr class="memdesc:a1eb3faf679b5ac141cf49a5e864d323f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy constructor.  <a href="#a1eb3faf679b5ac141cf49a5e864d323f">More...</a><br /></td></tr>
<tr class="separator:a1eb3faf679b5ac141cf49a5e864d323f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4716e6cea740384817610b8e647a75a"><td class="memItemLeft" align="right" valign="top">gcry_sexp_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#ad4716e6cea740384817610b8e647a75a">get_ephemeral_pub_key</a> () const </td></tr>
<tr class="memdesc:ad4716e6cea740384817610b8e647a75a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function for ephemeral pub key (Access is need for meta works like computing the session id which are not crypto task per se)  <a href="#ad4716e6cea740384817610b8e647a75a">More...</a><br /></td></tr>
<tr class="separator:ad4716e6cea740384817610b8e647a75a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a672406260b4e0ed8fb973223bc32052d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a672406260b4e0ed8fb973223bc32052d">init</a> ()</td></tr>
<tr class="separator:a672406260b4e0ed8fb973223bc32052d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f9ff2a12b080fc3085fc3304178a636"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a6f9ff2a12b080fc3085fc3304178a636">Encrypt</a> (std::string plain_text)</td></tr>
<tr class="memdesc:a6f9ff2a12b080fc3085fc3304178a636"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt a give plain text using the previously created ed25519 keys.  <a href="#a6f9ff2a12b080fc3085fc3304178a636">More...</a><br /></td></tr>
<tr class="separator:a6f9ff2a12b080fc3085fc3304178a636"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4669dd4ec7473a15e672402e6b76dfcd"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a4669dd4ec7473a15e672402e6b76dfcd">Decrypt</a> (std::string encrypted_text)</td></tr>
<tr class="memdesc:a4669dd4ec7473a15e672402e6b76dfcd"><td class="mdescLeft">&#160;</td><td class="mdescRight"><pre class="fragment"> Decrypt a give encrypted text using the previously created ed25519 keys
</pre><p> teddh *  <a href="#a4669dd4ec7473a15e672402e6b76dfcd">More...</a><br /></td></tr>
<tr class="separator:a4669dd4ec7473a15e672402e6b76dfcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11a64690baa00927f638d7a2969efdf5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a11a64690baa00927f638d7a2969efdf5">triple_ed_dh</a> (<a class="el" href="namespacenp1sec.html#ac67769ef56b2f6aec35bf42ca77404d3">np1secPublicKey</a> peer_ephemeral_key, <a class="el" href="namespacenp1sec.html#ac67769ef56b2f6aec35bf42ca77404d3">np1secPublicKey</a> peer_long_term_key, <a class="el" href="namespacenp1sec.html#aa633fa9ce8928fc333fc6cd1115a455e">np1secAsymmetricKey</a> my_long_term_key, bool peer_is_first, <a class="el" href="namespacenp1sec.html#a19000427258366e54c060914e1d9b389">HashBlock</a> *teddh_token)</td></tr>
<tr class="memdesc:a11a64690baa00927f638d7a2969efdf5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given the peer's long term and ephemeral public key AP and ap, and ours BP, bP, all points on ed25519 curve, this compute the triple dh value.  <a href="#a11a64690baa00927f638d7a2969efdf5">More...</a><br /></td></tr>
<tr class="separator:a11a64690baa00927f638d7a2969efdf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca0ebfd3a0493276345607dc855b5c3f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#aca0ebfd3a0493276345607dc855b5c3f">sign</a> (unsigned char **sigp, size_t *siglenp, std::string plain_text)</td></tr>
<tr class="memdesc:aca0ebfd3a0493276345607dc855b5c3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a valid std:string sign the string using the sessions private key and store the signature in *sigp with *siglenp throw exception in case of failure.  <a href="#aca0ebfd3a0493276345607dc855b5c3f">More...</a><br /></td></tr>
<tr class="separator:aca0ebfd3a0493276345607dc855b5c3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaeeed9749100f1063d9338aab5d0b066"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#aaeeed9749100f1063d9338aab5d0b066">verify</a> (std::string signed_text, const unsigned char *sigbuf, <a class="el" href="namespacenp1sec.html#ac67769ef56b2f6aec35bf42ca77404d3">np1secPublicKey</a> signer_ephmeral_pub_key)</td></tr>
<tr class="memdesc:aaeeed9749100f1063d9338aab5d0b066"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a signed piece of data and a valid signature verify if the signature is correct using the sessions public key.  <a href="#aaeeed9749100f1063d9338aab5d0b066">More...</a><br /></td></tr>
<tr class="separator:aaeeed9749100f1063d9338aab5d0b066"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae81b8895ab971472f0d32ce1c2d71193"><td class="memItemLeft" align="right" valign="top">gcry_cipher_hd_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#ae81b8895ab971472f0d32ce1c2d71193">OpenCipher</a> ()</td></tr>
<tr class="memdesc:ae81b8895ab971472f0d32ce1c2d71193"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create instance of cipher session based on configured algorithm, mode, key and iv.  <a href="#ae81b8895ab971472f0d32ce1c2d71193">More...</a><br /></td></tr>
<tr class="separator:ae81b8895ab971472f0d32ce1c2d71193"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd0809364e4b18d9c08c8d21656d436b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#abd0809364e4b18d9c08c8d21656d436b">~Cryptic</a> ()</td></tr>
<tr class="memdesc:abd0809364e4b18d9c08c8d21656d436b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Zeroising all secret key materials.  <a href="#abd0809364e4b18d9c08c8d21656d436b">More...</a><br /></td></tr>
<tr class="separator:abd0809364e4b18d9c08c8d21656d436b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ac7ac52e22f9aef77900aa81b7e1bfe92"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#ac7ac52e22f9aef77900aa81b7e1bfe92">public_key_to_stringbuff</a> (<a class="el" href="namespacenp1sec.html#aa633fa9ce8928fc333fc6cd1115a455e">np1secAsymmetricKey</a> public_key)</td></tr>
<tr class="separator:ac7ac52e22f9aef77900aa81b7e1bfe92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a250d55085bc72774c5f3fdaddb4e43ae"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a250d55085bc72774c5f3fdaddb4e43ae">generate_key_pair</a> (<a class="el" href="namespacenp1sec.html#aa633fa9ce8928fc333fc6cd1115a455e">np1secAsymmetricKey</a> *generated_key)</td></tr>
<tr class="memdesc:a250d55085bc72774c5f3fdaddb4e43ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a random ed25519 key pair.  <a href="#a250d55085bc72774c5f3fdaddb4e43ae">More...</a><br /></td></tr>
<tr class="separator:a250d55085bc72774c5f3fdaddb4e43ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dc6387001bc552f23f2dfdb47a8ceed"><td class="memItemLeft" align="right" valign="top">static gcry_sexp_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a5dc6387001bc552f23f2dfdb47a8ceed">get_public_key</a> (<a class="el" href="namespacenp1sec.html#aa633fa9ce8928fc333fc6cd1115a455e">np1secAsymmetricKey</a> key_pair)</td></tr>
<tr class="memdesc:a5dc6387001bc552f23f2dfdb47a8ceed"><td class="mdescLeft">&#160;</td><td class="mdescRight">get a key pair generated by libgcypt in sexp_t format and extract out the public key (for announcement) key need to be released  <a href="#a5dc6387001bc552f23f2dfdb47a8ceed">More...</a><br /></td></tr>
<tr class="separator:a5dc6387001bc552f23f2dfdb47a8ceed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61d607192e163435e8ffc0755963ae6f"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a61d607192e163435e8ffc0755963ae6f">retrieve_result</a> (gcry_sexp_t text_sexp)</td></tr>
<tr class="memdesc:a61d607192e163435e8ffc0755963ae6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a given gcrypt s-expression into a std::string.  <a href="#a61d607192e163435e8ffc0755963ae6f">More...</a><br /></td></tr>
<tr class="separator:a61d607192e163435e8ffc0755963ae6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3036c563f243ab5ef11b72004431203"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#ac3036c563f243ab5ef11b72004431203">release_crypto_resource</a> (gcry_sexp_t crypto_resource)</td></tr>
<tr class="separator:ac3036c563f243ab5ef11b72004431203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39c2000fc678e29a87c328c18843435b"><td class="memItemLeft" align="right" valign="top">static gcry_sexp_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a39c2000fc678e29a87c328c18843435b">copy_crypto_resource</a> (gcry_sexp_t crypto_resource)</td></tr>
<tr class="separator:a39c2000fc678e29a87c328c18843435b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a957d2e90bd137ba51a8694b54bf3c170"><td class="memItemLeft" align="right" valign="top">static gcry_error_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a957d2e90bd137ba51a8694b54bf3c170">hash</a> (const void *buffer, size_t buffer_len, <a class="el" href="namespacenp1sec.html#a19000427258366e54c060914e1d9b389">HashBlock</a> hb, bool secure=true)</td></tr>
<tr class="separator:a957d2e90bd137ba51a8694b54bf3c170"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f1b9ec0d2fd2313a531f2b59ff11d93"><td class="memItemLeft" align="right" valign="top">static gcry_error_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a0f1b9ec0d2fd2313a531f2b59ff11d93">hash</a> (const std::string string_buffer, <a class="el" href="namespacenp1sec.html#a19000427258366e54c060914e1d9b389">HashBlock</a> hb, bool secure=true)</td></tr>
<tr class="separator:a0f1b9ec0d2fd2313a531f2b59ff11d93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f5ffc9850fe3154e4316d961977ff1f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacenp1sec.html#aa6f183b407a756b423a042608ecc77c8">HashStdBlock</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a8f5ffc9850fe3154e4316d961977ff1f">hash</a> (const std::string string_buffer, bool secure=true)</td></tr>
<tr class="separator:a8f5ffc9850fe3154e4316d961977ff1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21ce4b8f2e6d7232ee1c4bc44ce9dd07"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a21ce4b8f2e6d7232ee1c4bc44ce9dd07">compare_hash</a> (const <a class="el" href="namespacenp1sec.html#a19000427258366e54c060914e1d9b389">HashBlock</a> rhs, const <a class="el" href="namespacenp1sec.html#a19000427258366e54c060914e1d9b389">HashBlock</a> lhs)</td></tr>
<tr class="separator:a21ce4b8f2e6d7232ee1c4bc44ce9dd07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9beaeeaa30a20245a94c36282d689d3"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#ab9beaeeaa30a20245a94c36282d689d3">hash_to_string_buff</a> (const <a class="el" href="namespacenp1sec.html#a19000427258366e54c060914e1d9b389">HashBlock</a> hash_block)</td></tr>
<tr class="separator:ab9beaeeaa30a20245a94c36282d689d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52e02cf6b3569e45a3fd561b72027879"><td class="memItemLeft" align="right" valign="top">static const uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a52e02cf6b3569e45a3fd561b72027879">strbuff_to_hash</a> (std::string &amp;hash_block_buffer)</td></tr>
<tr class="memdesc:a52e02cf6b3569e45a3fd561b72027879"><td class="mdescLeft">&#160;</td><td class="mdescRight">cast the string hash to unit8_t* dies if the size isn't correct the buffer is only valid as long as the HashStdBlock is valid  <a href="#a52e02cf6b3569e45a3fd561b72027879">More...</a><br /></td></tr>
<tr class="separator:a52e02cf6b3569e45a3fd561b72027879"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a127f27daf35d9e7381347a12b36ed815"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacenp1sec.html#ac67769ef56b2f6aec35bf42ca77404d3">np1secPublicKey</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a127f27daf35d9e7381347a12b36ed815">extract_public_key</a> (const <a class="el" href="namespacenp1sec.html#aa633fa9ce8928fc333fc6cd1115a455e">np1secAsymmetricKey</a> complete_key)</td></tr>
<tr class="memdesc:a127f27daf35d9e7381347a12b36ed815"><td class="mdescLeft">&#160;</td><td class="mdescRight">the given public key need to be explicitly released  <a href="#a127f27daf35d9e7381347a12b36ed815">More...</a><br /></td></tr>
<tr class="separator:a127f27daf35d9e7381347a12b36ed815"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09db97d089c2f3af069d60f1fe5ca66f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacenp1sec.html#aa633fa9ce8928fc333fc6cd1115a455e">np1secAsymmetricKey</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a09db97d089c2f3af069d60f1fe5ca66f">reconstruct_public_key_sexp</a> (const std::string pub_key_block)</td></tr>
<tr class="memdesc:a09db97d089c2f3af069d60f1fe5ca66f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function gets the value for q section of public-key and reconstruct the whole sexp to be used in libgcrypt functions.  <a href="#a09db97d089c2f3af069d60f1fe5ca66f">More...</a><br /></td></tr>
<tr class="separator:a09db97d089c2f3af069d60f1fe5ca66f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9afb7e53ad6aa22009235fe7ef2bb681"><td class="memItemLeft" align="right" valign="top">static gcry_sexp_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a9afb7e53ad6aa22009235fe7ef2bb681">convert_to_sexp</a> (std::string text)</td></tr>
<tr class="memdesc:a9afb7e53ad6aa22009235fe7ef2bb681"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a given std:string to a valid gcrypt s-expression.  <a href="#a9afb7e53ad6aa22009235fe7ef2bb681">More...</a><br /></td></tr>
<tr class="separator:a9afb7e53ad6aa22009235fe7ef2bb681"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ac6729e8e811e017561ba4f9702debe52"><td class="memItemLeft" align="right" valign="top">gcry_sexp_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#ac6729e8e811e017561ba4f9702debe52">ephemeral_key</a> = nullptr</td></tr>
<tr class="separator:ac6729e8e811e017561ba4f9702debe52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37c3837f231f12fb64c494a7f6475926"><td class="memItemLeft" align="right" valign="top">gcry_sexp_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a37c3837f231f12fb64c494a7f6475926">ephemeral_pub_key</a> = nullptr</td></tr>
<tr class="separator:a37c3837f231f12fb64c494a7f6475926"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f69ba79463801c2fb862258b631b7a1"><td class="memItemLeft" align="right" valign="top">gcry_sexp_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a5f69ba79463801c2fb862258b631b7a1">ephemeral_prv_key</a> = nullptr</td></tr>
<tr class="separator:a5f69ba79463801c2fb862258b631b7a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a938818a52129ea69a4b360e4468d8334"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacenp1sec.html#a3330448274be16cffaf184d10f86a749">np1secSymmetricKey</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a938818a52129ea69a4b360e4468d8334">session_key</a></td></tr>
<tr class="separator:a938818a52129ea69a4b360e4468d8334"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr class="memitem:a357783e04fee4e5c77ecc15e4f272fd6"><td class="memItemLeft" align="right" valign="top">static const uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a357783e04fee4e5c77ecc15e4f272fd6">ED25519_KEY_SIZE</a> = 32</td></tr>
<tr class="separator:a357783e04fee4e5c77ecc15e4f272fd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18a496575edea5ef0a686610bffa677c"><td class="memItemLeft" align="right" valign="top">static const gcry_mpi_format&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1Cryptic.html#a18a496575edea5ef0a686610bffa677c">NP1SEC_BLOB_OUT_FORMAT</a> = GCRYMPI_FMT_USG</td></tr>
<tr class="separator:a18a496575edea5ef0a686610bffa677c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Encryption primitives and related definitions. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="af2d26c2bd24ca7cb0730dacee1cbf36d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">np1sec::Cryptic::Cryptic </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor setup the key. </p>

</div>
</div>
<a class="anchor" id="a1eb3faf679b5ac141cf49a5e864d323f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">np1sec::Cryptic::Cryptic </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnp1sec_1_1Cryptic.html">Cryptic</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy constructor. </p>

</div>
</div>
<a class="anchor" id="abd0809364e4b18d9c08c8d21656d436b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">np1sec::Cryptic::~Cryptic </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Zeroising all secret key materials. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a54611544c61e55c6c39e32a01fc4dc8f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void np1sec::Cryptic::set_session_key </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacenp1sec.html#a19000427258366e54c060914e1d9b389">HashBlock</a>&#160;</td>
          <td class="paramname"><em>session_key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad4716e6cea740384817610b8e647a75a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gcry_sexp_t np1sec::Cryptic::get_ephemeral_pub_key </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access function for ephemeral pub key (Access is need for meta works like computing the session id which are not crypto task per se) </p>

</div>
</div>
<a class="anchor" id="ac7ac52e22f9aef77900aa81b7e1bfe92"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string np1sec::Cryptic::public_key_to_stringbuff </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacenp1sec.html#aa633fa9ce8928fc333fc6cd1115a455e">np1secAsymmetricKey</a>&#160;</td>
          <td class="paramname"><em>public_key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a672406260b4e0ed8fb973223bc32052d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool np1sec::Cryptic::init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a6f9ff2a12b080fc3085fc3304178a636"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string np1sec::Cryptic::Encrypt </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>plain_text</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt a give plain text using the previously created ed25519 keys. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">plain_text</td><td>a plain text message string to be encrypted</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a string containing the encrypted text </dd></dl>

</div>
</div>
<a class="anchor" id="a4669dd4ec7473a15e672402e6b76dfcd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string np1sec::Cryptic::Decrypt </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>encrypted_text</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><pre class="fragment"> Decrypt a give encrypted text using the previously created ed25519 keys
</pre><p> teddh * </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encrypted_text</td><td>an encrypted text message string to be decrypted</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a string containing the decrypted text </dd></dl>

</div>
</div>
<a class="anchor" id="a250d55085bc72774c5f3fdaddb4e43ae"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool np1sec::Cryptic::generate_key_pair </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacenp1sec.html#aa633fa9ce8928fc333fc6cd1115a455e">np1secAsymmetricKey</a> *&#160;</td>
          <td class="paramname"><em>generated_key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generates a random ed25519 key pair. </p>
<dl class="section return"><dt>Returns</dt><dd>false in case of error otherwise true </dd></dl>

</div>
</div>
<a class="anchor" id="a5dc6387001bc552f23f2dfdb47a8ceed"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gcry_sexp_t np1sec::Cryptic::get_public_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacenp1sec.html#aa633fa9ce8928fc333fc6cd1115a455e">np1secAsymmetricKey</a>&#160;</td>
          <td class="paramname"><em>key_pair</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get a key pair generated by libgcypt in sexp_t format and extract out the public key (for announcement) key need to be released </p>

</div>
</div>
<a class="anchor" id="a61d607192e163435e8ffc0755963ae6f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string np1sec::Cryptic::retrieve_result </td>
          <td>(</td>
          <td class="paramtype">gcry_sexp_t&#160;</td>
          <td class="paramname"><em>text_sexp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert a given gcrypt s-expression into a std::string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gcry_sexp_t</td><td>gcrypt s-expression to be converted</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::string representing the converted data. </dd></dl>

</div>
</div>
<a class="anchor" id="ac3036c563f243ab5ef11b72004431203"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void np1sec::Cryptic::release_crypto_resource </td>
          <td>(</td>
          <td class="paramtype">gcry_sexp_t&#160;</td>
          <td class="paramname"><em>crypto_resource</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a39c2000fc678e29a87c328c18843435b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gcry_sexp_t np1sec::Cryptic::copy_crypto_resource </td>
          <td>(</td>
          <td class="paramtype">gcry_sexp_t&#160;</td>
          <td class="paramname"><em>crypto_resource</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a957d2e90bd137ba51a8694b54bf3c170"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gcry_error_t np1sec::Cryptic::hash </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buffer_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacenp1sec.html#a19000427258366e54c060914e1d9b389">HashBlock</a>&#160;</td>
          <td class="paramname"><em>hb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>secure</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a0f1b9ec0d2fd2313a531f2b59ff11d93"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static gcry_error_t np1sec::Cryptic::hash </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>string_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacenp1sec.html#a19000427258366e54c060914e1d9b389">HashBlock</a>&#160;</td>
          <td class="paramname"><em>hb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>secure</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a8f5ffc9850fe3154e4316d961977ff1f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacenp1sec.html#aa6f183b407a756b423a042608ecc77c8">HashStdBlock</a> np1sec::Cryptic::hash </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>string_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>secure</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a21ce4b8f2e6d7232ee1c4bc44ce9dd07"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int np1sec::Cryptic::compare_hash </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacenp1sec.html#a19000427258366e54c060914e1d9b389">HashBlock</a>&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacenp1sec.html#a19000427258366e54c060914e1d9b389">HashBlock</a>&#160;</td>
          <td class="paramname"><em>lhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab9beaeeaa30a20245a94c36282d689d3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::string np1sec::Cryptic::hash_to_string_buff </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacenp1sec.html#a19000427258366e54c060914e1d9b389">HashBlock</a>&#160;</td>
          <td class="paramname"><em>hash_block</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a52e02cf6b3569e45a3fd561b72027879"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static const uint8_t* np1sec::Cryptic::strbuff_to_hash </td>
          <td>(</td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>hash_block_buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>cast the string hash to unit8_t* dies if the size isn't correct the buffer is only valid as long as the HashStdBlock is valid </p>

</div>
</div>
<a class="anchor" id="a127f27daf35d9e7381347a12b36ed815"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacenp1sec.html#ac67769ef56b2f6aec35bf42ca77404d3">np1secPublicKey</a> np1sec::Cryptic::extract_public_key </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacenp1sec.html#aa633fa9ce8928fc333fc6cd1115a455e">np1secAsymmetricKey</a>&#160;</td>
          <td class="paramname"><em>complete_key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the given public key need to be explicitly released </p>

</div>
</div>
<a class="anchor" id="a09db97d089c2f3af069d60f1fe5ca66f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacenp1sec.html#aa633fa9ce8928fc333fc6cd1115a455e">np1secAsymmetricKey</a> np1sec::Cryptic::reconstruct_public_key_sexp </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>pub_key_block</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function gets the value for q section of public-key and reconstruct the whole sexp to be used in libgcrypt functions. </p>
<p>[open] [data="public-key"] [open] [data="ecc"] [open] [data="curve"] [data="Ed25519"] [close] [open] [data="flags"] [data="eddsa"] [close] [open] [data="q"] [data="\xb83jR\xea\xebtI\xab\\x91E\xda\xff|Y\x94\xe1\xeck\xa8I&lt;d\x804+\x18\x9b\xe5\x7f!"] [close] [close] [close] </p>

</div>
</div>
<a class="anchor" id="a9afb7e53ad6aa22009235fe7ef2bb681"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gcry_sexp_t np1sec::Cryptic::convert_to_sexp </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>text</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert a given std:string to a valid gcrypt s-expression. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">std::string</td><td>valid string to be converted</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>gcry_sexp_t gcrypt s-expression respresentation </dd></dl>

</div>
</div>
<a class="anchor" id="a11a64690baa00927f638d7a2969efdf5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void np1sec::Cryptic::triple_ed_dh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacenp1sec.html#ac67769ef56b2f6aec35bf42ca77404d3">np1secPublicKey</a>&#160;</td>
          <td class="paramname"><em>peer_ephemeral_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacenp1sec.html#ac67769ef56b2f6aec35bf42ca77404d3">np1secPublicKey</a>&#160;</td>
          <td class="paramname"><em>peer_long_term_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacenp1sec.html#aa633fa9ce8928fc333fc6cd1115a455e">np1secAsymmetricKey</a>&#160;</td>
          <td class="paramname"><em>my_long_term_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>peer_is_first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacenp1sec.html#a19000427258366e54c060914e1d9b389">HashBlock</a> *&#160;</td>
          <td class="paramname"><em>teddh_token</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given the peer's long term and ephemeral public key AP and ap, and ours BP, bP, all points on ed25519 curve, this compute the triple dh value. </p>
<p>n </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">peer_ephemeral_key</td><td>the ephemeral public key of peer i.e. aP in grcypt eddsa public key format </td></tr>
    <tr><td class="paramname">peer_long_term_key</td><td>the long term public key of the peer i.e AP in gcrypt eddsa public key format </td></tr>
    <tr><td class="paramname">my_long_term_key</td><td>our longterm key in eddsa format </td></tr>
    <tr><td class="paramname">peer_is_first</td><td>true if AP.X|AP.Y &lt; BP.X|BP.Y </td></tr>
    <tr><td class="paramname">teddh_token</td><td>a pointer to hash block to store hash(bAP|BaP|baP) if peer_is_first hash(BaP|bAP|baP) in GCRYMPI_FMT_USG format if the pointer is null , necessary space will be allocated.</td></tr>
  </table>
  </dd>
</dl>
<p>throw an exception if the operation fails, true on success</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">peer_ephemeral_key</td><td>the ephemeral public key of peer i.e. aP in grcypt eddsa public key format </td></tr>
    <tr><td class="paramname">peer_long_term_key</td><td>the long term public key of the peer i.e AP in gcrypt eddsa public key format </td></tr>
    <tr><td class="paramname">my_long_term_key</td><td>our longterm key in eddsa format </td></tr>
    <tr><td class="paramname">order</td><td></td></tr>
    <tr><td class="paramname">teddh_token</td><td>a pointer to hash block to store hash(bAP|BaP|baP) if AP.X|AP.Y &lt; BP.X|BP.Y other wise hash(BaP|bAP|baP) in GCRYMPI_FMT_USG format if the pointer is null , necessary space will be allocated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if succeeds otherwise false </dd></dl>

</div>
</div>
<a class="anchor" id="aca0ebfd3a0493276345607dc855b5c3f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void np1sec::Cryptic::sign </td>
          <td>(</td>
          <td class="paramtype">unsigned char **&#160;</td>
          <td class="paramname"><em>sigp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>siglenp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>plain_text</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a valid std:string sign the string using the sessions private key and store the signature in *sigp with *siglenp throw exception in case of failure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">unsigned</td><td>char ** representing a buffer to store the create signature </td></tr>
    <tr><td class="paramname">size_t</td><td>representing the length of the return sig buffer  std::string representing the message to be signed </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aaeeed9749100f1063d9338aab5d0b066"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool np1sec::Cryptic::verify </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>signed_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>sigbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacenp1sec.html#ac67769ef56b2f6aec35bf42ca77404d3">np1secPublicKey</a>&#160;</td>
          <td class="paramname"><em>signer_ephmeral_pub_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a signed piece of data and a valid signature verify if the signature is correct using the sessions public key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">std::string</td><td>representing signed data </td></tr>
    <tr><td class="paramname">const</td><td>unsigned char* representing data signature buffer </td></tr>
    <tr><td class="paramname">the</td><td>public key of the party who has signed the message</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the signature is valid false on false signature throw exception in case of error </dd></dl>

</div>
</div>
<a class="anchor" id="ae81b8895ab971472f0d32ce1c2d71193"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gcry_cipher_hd_t np1sec::Cryptic::OpenCipher </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create instance of cipher session based on configured algorithm, mode, key and iv. </p>
<dl class="section return"><dt>Returns</dt><dd>gcry_cipher_hd_t representing a cipher session handle </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="ac6729e8e811e017561ba4f9702debe52"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gcry_sexp_t np1sec::Cryptic::ephemeral_key = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a37c3837f231f12fb64c494a7f6475926"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gcry_sexp_t np1sec::Cryptic::ephemeral_pub_key = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a5f69ba79463801c2fb862258b631b7a1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gcry_sexp_t np1sec::Cryptic::ephemeral_prv_key = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a938818a52129ea69a4b360e4468d8334"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacenp1sec.html#a3330448274be16cffaf184d10f86a749">np1secSymmetricKey</a> np1sec::Cryptic::session_key</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a357783e04fee4e5c77ecc15e4f272fd6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const uint32_t np1sec::Cryptic::ED25519_KEY_SIZE = 32</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a18a496575edea5ef0a686610bffa677c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const gcry_mpi_format np1sec::Cryptic::NP1SEC_BLOB_OUT_FORMAT = GCRYMPI_FMT_USG</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="crypt_8h_source.html">crypt.h</a></li>
<li>src/<a class="el" href="crypt_8cc.html">crypt.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
