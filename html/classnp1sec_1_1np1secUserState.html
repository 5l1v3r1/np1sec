<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>(n+1)sec: np1sec::np1secUserState Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">(n+1)sec
   &#160;<span id="projectnumber">Version 1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacenp1sec.html">np1sec</a></li><li class="navelem"><a class="el" href="classnp1sec_1_1np1secUserState.html">np1secUserState</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classnp1sec_1_1np1secUserState-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">np1sec::np1secUserState Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Manages a user with long term identity for participating in a multiparty chat sessions.  
 <a href="classnp1sec_1_1np1secUserState.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="userstate_8h_source.html">userstate.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac680e25dec0dbe690f58d6f4b8b7b4dd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1np1secUserState.html#ac680e25dec0dbe690f58d6f4b8b7b4dd">np1secUserState</a> (std::string name, <a class="el" href="structnp1sec_1_1np1secAppOps.html">np1secAppOps</a> *<a class="el" href="classnp1sec_1_1np1secUserState.html#ac722efc73080fcb18d849aee7a6e01b1">ops</a>, uint8_t *key_pair=nullptr)</td></tr>
<tr class="memdesc:ac680e25dec0dbe690f58d6f4b8b7b4dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#ac680e25dec0dbe690f58d6f4b8b7b4dd">More...</a><br /></td></tr>
<tr class="separator:ac680e25dec0dbe690f58d6f4b8b7b4dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa09ab4086ce34325b1756824bf92c608"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1np1secUserState.html#aa09ab4086ce34325b1756824bf92c608">init</a> ()</td></tr>
<tr class="memdesc:aa09ab4086ce34325b1756824bf92c608"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exceptions:  <a href="#aa09ab4086ce34325b1756824bf92c608">More...</a><br /></td></tr>
<tr class="separator:aa09ab4086ce34325b1756824bf92c608"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1157a69d16156b6df56917057eb770c"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1np1secUserState.html#ae1157a69d16156b6df56917057eb770c">user_id</a> ()</td></tr>
<tr class="memdesc:ae1157a69d16156b6df56917057eb770c"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for nick  <a href="#ae1157a69d16156b6df56917057eb770c">More...</a><br /></td></tr>
<tr class="separator:ae1157a69d16156b6df56917057eb770c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0dede0b9775159c6108c7267c0b4b43"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1np1secUserState.html#ad0dede0b9775159c6108c7267c0b4b43">user_nick</a> ()</td></tr>
<tr class="separator:ad0dede0b9775159c6108c7267c0b4b43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a369e5ffb66a400e8900f2e217c412dbb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacenp1sec.html#aa5f9d56c9898cec56dca2d3653ce4baf">KeyPair</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1np1secUserState.html#a369e5ffb66a400e8900f2e217c412dbb">user_id_key</a> ()</td></tr>
<tr class="memdesc:a369e5ffb66a400e8900f2e217c412dbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for for long term id key  <a href="#a369e5ffb66a400e8900f2e217c412dbb">More...</a><br /></td></tr>
<tr class="separator:a369e5ffb66a400e8900f2e217c412dbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0698edcf35a07c344e7da74d792b94dc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1np1secUserState.html#a0698edcf35a07c344e7da74d792b94dc">join_room</a> (std::string room_name, std::vector&lt; std::string &gt; participants_in_the_room)</td></tr>
<tr class="memdesc:a0698edcf35a07c344e7da74d792b94dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">The client need to call this function when the user is joining a room.  <a href="#a0698edcf35a07c344e7da74d792b94dc">More...</a><br /></td></tr>
<tr class="separator:a0698edcf35a07c344e7da74d792b94dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a144fee8346716601c1668e5524bd2beb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1np1secUserState.html#a144fee8346716601c1668e5524bd2beb">send_handler</a> (std::string room_name, std::string plain_message)</td></tr>
<tr class="memdesc:a144fee8346716601c1668e5524bd2beb"><td class="mdescLeft">&#160;</td><td class="mdescRight">When the user uses the client interface to send a message the client need to call this function to send the message.  <a href="#a144fee8346716601c1668e5524bd2beb">More...</a><br /></td></tr>
<tr class="separator:a144fee8346716601c1668e5524bd2beb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef88bad9ae339e577c939e7b01ec237c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1np1secUserState.html#aef88bad9ae339e577c939e7b01ec237c">receive_handler</a> (std::string room_name, std::string sender_nickname, std::string np1sec_message, uint32_t message_id=0)</td></tr>
<tr class="memdesc:aef88bad9ae339e577c939e7b01ec237c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The client need to call this function whenever a message is received.  <a href="#aef88bad9ae339e577c939e7b01ec237c">More...</a><br /></td></tr>
<tr class="separator:aef88bad9ae339e577c939e7b01ec237c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa0cacdf96ccacac02496c717bb082bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1np1secUserState.html#aaa0cacdf96ccacac02496c717bb082bc">leave_room</a> (std::string room_name)</td></tr>
<tr class="memdesc:aaa0cacdf96ccacac02496c717bb082bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">The client informs the user state about leaving the room by calling this function.  <a href="#aaa0cacdf96ccacac02496c717bb082bc">More...</a><br /></td></tr>
<tr class="separator:aaa0cacdf96ccacac02496c717bb082bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84a78d0fc1c9bd63701be5eaa2f72ffa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1np1secUserState.html#a84a78d0fc1c9bd63701be5eaa2f72ffa">shrink</a> (std::string room_name, std::string leaving_user_id)</td></tr>
<tr class="memdesc:a84a78d0fc1c9bd63701be5eaa2f72ffa"><td class="mdescLeft">&#160;</td><td class="mdescRight">the client need to call this function when another user leave the chatroom.  <a href="#a84a78d0fc1c9bd63701be5eaa2f72ffa">More...</a><br /></td></tr>
<tr class="separator:a84a78d0fc1c9bd63701be5eaa2f72ffa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a699295d1301cb5aa8c1ff8b68de58dbb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1np1secUserState.html#a699295d1301cb5aa8c1ff8b68de58dbb">increment_room_size</a> (std::string room_name)</td></tr>
<tr class="memdesc:a699295d1301cb5aa8c1ff8b68de58dbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">called by the client when somebody else joins the room so we know how many people are in the room  <a href="#a699295d1301cb5aa8c1ff8b68de58dbb">More...</a><br /></td></tr>
<tr class="separator:a699295d1301cb5aa8c1ff8b68de58dbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1546a8cda95b3a768e0f703491838a22"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classnp1sec_1_1np1secSession.html">np1secSession</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1np1secUserState.html#a1546a8cda95b3a768e0f703491838a22">retrieve_session</a> (std::string room_name)</td></tr>
<tr class="memdesc:a1546a8cda95b3a768e0f703491838a22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the session object associated with the given room name.  <a href="#a1546a8cda95b3a768e0f703491838a22">More...</a><br /></td></tr>
<tr class="separator:a1546a8cda95b3a768e0f703491838a22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6045242fb827a79a878d8f6a1779003d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1np1secUserState.html#a6045242fb827a79a878d8f6a1779003d">~np1secUserState</a> ()</td></tr>
<tr class="separator:a6045242fb827a79a878d8f6a1779003d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a360b7bc3d3bc8861c4d526f9c8a2b8ec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structnp1sec_1_1ParticipantId.html">ParticipantId</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1np1secUserState.html#a360b7bc3d3bc8861c4d526f9c8a2b8ec">myself</a></td></tr>
<tr class="separator:a360b7bc3d3bc8861c4d526f9c8a2b8ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40b4c0d19207056ef0b19001427f2015"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classnp1sec_1_1LongTermIDKey.html">LongTermIDKey</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1np1secUserState.html#a40b4c0d19207056ef0b19001427f2015">long_term_key_pair</a></td></tr>
<tr class="separator:a40b4c0d19207056ef0b19001427f2015"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12626df30c88a264f397f7b285107d4a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacenp1sec.html#a675e1b0c04d4b25d91d747f014713660">RoomMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1np1secUserState.html#a12626df30c88a264f397f7b285107d4a">chatrooms</a></td></tr>
<tr class="separator:a12626df30c88a264f397f7b285107d4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac722efc73080fcb18d849aee7a6e01b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structnp1sec_1_1np1secAppOps.html">np1secAppOps</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnp1sec_1_1np1secUserState.html#ac722efc73080fcb18d849aee7a6e01b1">ops</a></td></tr>
<tr class="separator:ac722efc73080fcb18d849aee7a6e01b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Manages a user with long term identity for participating in a multiparty chat sessions. </p>
<p>It keeps track of sessions that user is participating in. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ac680e25dec0dbe690f58d6f4b8b7b4dd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">np1sec::np1secUserState::np1secUserState </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structnp1sec_1_1np1secAppOps.html">np1secAppOps</a> *&#160;</td>
          <td class="paramname"><em>ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>key_pair</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<p>The client only calls functions in <a class="el" href="classnp1sec_1_1np1secUserState.html" title="Manages a user with long term identity for participating in a multiparty chat sessions. ">np1secUserState</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>the user name which is going to be used as default nickname for the rooms </td></tr>
    <tr><td class="paramname">key_pair</td><td>the binary blob which contains the long term identity key pair for ED25519.</td></tr>
  </table>
  </dd>
</dl>
<p>As such, the client need to handle exception (or false return values) that is resulted from these calls. In most situation, handling simply means to inform the user about the failure.</p>
<p>In principal, the client should be aware of all exception reported to the userstate.</p>
<p>Exceptions:</p>
<p>If we are not able to make the UserState Object mostly because the long term key has wrong format, the client need to know that the creation of the user state object had failed. However, as the constructor is not able to return value, our only option is to throw an exception. </p>

</div>
</div>
<a class="anchor" id="a6045242fb827a79a878d8f6a1779003d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">np1sec::np1secUserState::~np1secUserState </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aa09ab4086ce34325b1756824bf92c608"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool np1sec::np1secUserState::init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Exceptions: </p>
<p>If the generation of the long term key fails, mainly due to lack of randomness, then the client need to be informed that we are not able to connect to any room in this situation. </p>

</div>
</div>
<a class="anchor" id="ae1157a69d16156b6df56917057eb770c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string np1sec::np1secUserState::user_id </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>access function for nick </p>

</div>
</div>
<a class="anchor" id="ad0dede0b9775159c6108c7267c0b4b43"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string np1sec::np1secUserState::user_nick </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a369e5ffb66a400e8900f2e217c412dbb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacenp1sec.html#aa5f9d56c9898cec56dca2d3653ce4baf">KeyPair</a> np1sec::np1secUserState::user_id_key </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>access function for for long term id key </p>

</div>
</div>
<a class="anchor" id="a0698edcf35a07c344e7da74d792b94dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool np1sec::np1secUserState::join_room </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>room_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>participants_in_the_room</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The client need to call this function when the user is joining a room. </p>
<p>Exceptions:</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">room_name</td><td>the chat room name</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true in case of success (does not mean successful join) and false in case of failure. client need to inform server of leaving the room in case of failure</dd></dl>
<p>This function initiating the join process, even if it ends successful * ly it doesn't mean that we have joined the room as join is a multi round process.</p>
<p>The intiation can fails only if our crypto values have problem. or the network conditino makes sending the initiation message impossible. the inititation message only contains the long term and ephemeral public keys.</p>
<p>Another condition which can make the failure of join inititation is that if we are already has joined a session in this room. </p>

</div>
</div>
<a class="anchor" id="a144fee8346716601c1668e5524bd2beb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void np1sec::np1secUserState::send_handler </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>room_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>plain_message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>When the user uses the client interface to send a message the client need to call this function to send the message. </p>
<p>Exception:</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">room_name</td><td>the chat room name </td></tr>
    <tr><td class="paramname">plain_message</td><td>unencrypted message needed to be send securely</td></tr>
  </table>
  </dd>
</dl>
<p>send can fails due to the fact that the client tries to send a a message to a room that the user haven't joined (join processes) has not ended successfully. </p>

</div>
</div>
<a class="anchor" id="aef88bad9ae339e577c939e7b01ec237c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void np1sec::np1secUserState::receive_handler </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>room_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>sender_nickname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>received_message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>message_id</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The client need to call this function whenever a message is received. </p>
<p>This is the main message handler of the whole protocol:</p>
<p>This function uses the content of the message and the status of the room to interpret the message</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">room_name</td><td>the chat room name </td></tr>
    <tr><td class="paramname">np1sec_message</td><td>the message needed to be sent</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a <a class="el" href="classnp1sec_1_1RoomAction.html">RoomAction</a> object informing the client how to update the interface (add, remove user or display a message</dd></dl>
<p>The most important thing that user state message handler does is to</p><ul>
<li>Process the unencrypted part of the message.</li>
<li>decide which room should handle the message using the room name</li>
</ul>
<p>Exception: Failure of digesting a message, due to be encrypted by an unknown key or a manipulated message need to be reported to the client, to warn the user about it, but the client can't do much more about it. </p>

</div>
</div>
<a class="anchor" id="aaa0cacdf96ccacac02496c717bb082bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void np1sec::np1secUserState::leave_room </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>room_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The client informs the user state about leaving the room by calling this function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">room_name</td><td>the chat room name to leave from</td></tr>
    <tr><td class="paramname">room_name</td><td>the chat room name to leave from</td></tr>
  </table>
  </dd>
</dl>
<p>Exception: If the client asks us to leave a room that we haven't join, then we have to inform the client about its mistake. </p>

</div>
</div>
<a class="anchor" id="a84a78d0fc1c9bd63701be5eaa2f72ffa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void np1sec::np1secUserState::shrink </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>room_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>leaving_user_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the client need to call this function when another user leave the chatroom. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">room_name</td><td>the chat room name </td></tr>
    <tr><td class="paramname">leaving_user_id</td><td>is the id that the leaving user is using in the room.</td></tr>
  </table>
  </dd>
</dl>
<p>throw an exception if the user isn't in the room. no exception doesn't mean that the successful leave false if process fails</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">room_name</td><td>the chat room name </td></tr>
    <tr><td class="paramname">leaving_user_id</td><td>is the id that the leaving user is using in the room.</td></tr>
  </table>
  </dd>
</dl>
<p>Exception: throw an exception if the user isn't in the room. no exception doesn't mean that the successful </p>

</div>
</div>
<a class="anchor" id="a699295d1301cb5aa8c1ff8b68de58dbb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void np1sec::np1secUserState::increment_room_size </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>room_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>called by the client when somebody else joins the room so we know how many people are in the room </p>

</div>
</div>
<a class="anchor" id="a1546a8cda95b3a768e0f703491838a22"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classnp1sec_1_1np1secSession.html">np1secSession</a>* np1sec::np1secUserState::retrieve_session </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>room_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the session object associated with the given room name. </p>
<p>To allow sending and receiving of messages relative to that session</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">room_name</td><td>the chat room_name</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the current session if it exists. </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a360b7bc3d3bc8861c4d526f9c8a2b8ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnp1sec_1_1ParticipantId.html">ParticipantId</a>* np1sec::np1secUserState::myself</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a40b4c0d19207056ef0b19001427f2015"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classnp1sec_1_1LongTermIDKey.html">LongTermIDKey</a> np1sec::np1secUserState::long_term_key_pair</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a12626df30c88a264f397f7b285107d4a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacenp1sec.html#a675e1b0c04d4b25d91d747f014713660">RoomMap</a> np1sec::np1secUserState::chatrooms</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac722efc73080fcb18d849aee7a6e01b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnp1sec_1_1np1secAppOps.html">np1secAppOps</a>* np1sec::np1secUserState::ops</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="userstate_8h_source.html">userstate.h</a></li>
<li>src/<a class="el" href="userstate_8cc.html">userstate.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
